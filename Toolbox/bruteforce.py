import ssl
import socket

def analyze_ssl_tls(host, port=443):
    # Create a default context that uses secure settings
    context = ssl.create_default_context()

    try:
        conn = context.wrap_socket(socket.socket(socket.AF_INET), server_hostname=host)
        conn.settimeout(10.0)  # Timeout for connection attempts
        conn.connect((host, port))
        ssl_info = conn.getpeercert()

        # Fetch and print details
        print(f"SSL/TLS connection to {host} established.")
        print("Certificate Details:")
        for key, value in ssl_info.items():
            print(f"{key}: {value}")

        # Cipher being used
        cipher = conn.cipher()
        print(f"\nCipher Suite in Use: {cipher}")

        # Close the connection
        conn.close()

    except Exception as e:
        print(f"Failed to connect or analyze SSL/TLS for {host}:{port}. Error: {e}")

if __name__ == "__main__":
    host = input("Enter the host to analyze (e.g., example.com): ")
    analyze_ssl_tls(host)
